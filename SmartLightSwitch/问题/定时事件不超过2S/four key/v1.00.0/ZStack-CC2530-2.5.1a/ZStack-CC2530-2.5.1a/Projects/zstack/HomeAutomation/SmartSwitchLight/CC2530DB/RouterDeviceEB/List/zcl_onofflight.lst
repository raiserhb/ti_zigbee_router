###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         26/Oct/2016  15:53:32 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\work space\Smart Product\SmartLightSwitch\four  #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\Source\zcl_onofflight.c                          #
#    Command line       =  -f "D:\work space\Smart Product\SmartLightSwitch\f #
#                          our key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530 #
#                          -2.5.1a\Projects\zstack\HomeAutomation\SmartSwitch #
#                          Light\CC2530DB\..\Tools\CC2530DB\f8wRouter.cfg"    #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_APP_PENDING_QUEUE=TRUE                   #
#                          -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8         #
#                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK -DNV_RESTORE          #
#                          -DNV_INIT -DHAL_KEY=FALSE -DHAL_LED=FALSE          #
#                          -DHAL_LCD=FALSE -DHAL_ADC=FALSE                    #
#                          -DTC_LINKKEY_JOIN) -f "D:\work space\Smart         #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\Tools\CC2530DB\f8wConfig.cfg"        #
#                          (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0      #
#                          -DREFLECTOR -DDEFAULT_CHANLIST=0x00000800          #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=1000              #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4                        #
#                          -DDEFAULT_KEY={0x58,0x69,0x6E,0x67,0x48,0x75,0x6F, #
#                          0x59,0x75,0x61,0x6E,0x53,0x6D,0x61,0x72,0x74}      #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=TRUE -DPOLL_RATE=0            #
#                          -DQUEUED_POLL_RATE=0 -DRESPONSE_POLL_RATE=0        #
#                          -DREJOIN_POLL_RATE=440) -f "D:\work space\Smart    #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\Tools\CC2530DB\f8wZCL.cfg"           #
#                          (-DZCL_READ -DZCL_WRITE -DZCL_REPORT -DZCL_BASIC   #
#                          -DZCL_IDENTIFY -DZCL_ON_OFF -DZCL_KEY_ESTABLISH    #
#                          -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4     #
#                          -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10    #
#                          -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10   #
#                          -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING           #
#                          -DZCL_PRICING -DZCL_MESSAGE -DZCL_TUNNELING        #
#                          -DZCL_TOU) -DZCL_DEVICE_MGMT "D:\work space\Smart  #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\Source\zcl_onofflight.c" -lC "D:\work            #
#                          space\Smart Product\SmartLightSwitch\four          #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\RouterDeviceEB\List\" -lA "D:\work      #
#                          space\Smart Product\SmartLightSwitch\four          #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\RouterDeviceEB\List\" --diag_suppress   #
#                          Pe001,Pa010 -o "D:\work space\Smart                #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\RouterDeviceEB\Obj\" -e --debug         #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "D:\work space\Smart       #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\" -I "D:\work space\Smart               #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\Source\" -I "D:\work space\Smart     #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\Source\" -I "D:\work space\Smart  #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\ZMain\TI2530DB\" -I "D:\work   #
#                          space\Smart Product\SmartLightSwitch\four          #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\hal\include\" #
#                           -I "D:\work space\Smart                           #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\hal\target\CC #
#                          2530EB\" -I "D:\work space\Smart                   #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\mac\include\" #
#                           -I "D:\work space\Smart                           #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\mac\high_leve #
#                          l\" -I "D:\work space\Smart                        #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\mac\low_level #
#                          \srf04\" -I "D:\work space\Smart                   #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\mac\low_level #
#                          \srf04\single_chip\" -I "D:\work space\Smart       #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\mt\" -I       #
#                          "D:\work space\Smart Product\SmartLightSwitch\four #
#                           key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2. #
#                          5.1a\Projects\zstack\HomeAutomation\SmartSwitchLig #
#                          ht\CC2530DB\..\..\..\..\..\Components\osal\include #
#                          \" -I "D:\work space\Smart                         #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\services\sadd #
#                          r\" -I "D:\work space\Smart                        #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\services\sdat #
#                          a\" -I "D:\work space\Smart                        #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\stack\af\"    #
#                          -I "D:\work space\Smart Product\SmartLightSwitch\f #
#                          our key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530 #
#                          -2.5.1a\Projects\zstack\HomeAutomation\SmartSwitch #
#                          Light\CC2530DB\..\..\..\..\..\Components\stack\nwk #
#                          \" -I "D:\work space\Smart                         #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\stack\sapi\"  #
#                          -I "D:\work space\Smart Product\SmartLightSwitch\f #
#                          our key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530 #
#                          -2.5.1a\Projects\zstack\HomeAutomation\SmartSwitch #
#                          Light\CC2530DB\..\..\..\..\..\Components\stack\sec #
#                          \" -I "D:\work space\Smart                         #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\stack\sys\"   #
#                          -I "D:\work space\Smart Product\SmartLightSwitch\f #
#                          our key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530 #
#                          -2.5.1a\Projects\zstack\HomeAutomation\SmartSwitch #
#                          Light\CC2530DB\..\..\..\..\..\Components\stack\zcl #
#                          \" -I "D:\work space\Smart                         #
#                          Product\SmartLightSwitch\four                      #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\..\..\..\..\..\Components\stack\zdo\"   #
#                          -I "D:\work space\Smart Product\SmartLightSwitch\f #
#                          our key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530 #
#                          -2.5.1a\Projects\zstack\HomeAutomation\SmartSwitch #
#                          Light\CC2530DB\..\..\..\..\..\Components\zmac\"    #
#                          -I "D:\work space\Smart Product\SmartLightSwitch\f #
#                          our key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530 #
#                          -2.5.1a\Projects\zstack\HomeAutomation\SmartSwitch #
#                          Light\CC2530DB\..\..\..\..\..\Components\zmac\f8w\ #
#                          " -Oh --require_prototypes                         #
#    List file          =  D:\work space\Smart Product\SmartLightSwitch\four  #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\RouterDeviceEB\List\zcl_onofflight.lst  #
#    Object file        =  D:\work space\Smart Product\SmartLightSwitch\four  #
#                          key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5 #
#                          .1a\Projects\zstack\HomeAutomation\SmartSwitchLigh #
#                          t\CC2530DB\RouterDeviceEB\Obj\zcl_onofflight.r51   #
#                                                                             #
#                                                                             #
###############################################################################

D:\work space\Smart Product\SmartLightSwitch\four key\v1.00.0\ZStack-CC2530-2.5.1a\ZStack-CC2530-2.5.1a\Projects\zstack\HomeAutomation\SmartSwitchLight\Source\zcl_onofflight.c
      1          /**************************************************************************************************
      2            Filename:       zcl_sampleLight.c
      3            Revised:        $Date: 2009-03-18 15:56:27 -0700 (Wed, 18 Mar 2009) $
      4            Revision:       $Revision: 19453 $
      5          
      6          
      7            Description:    Zigbee Cluster Library - sample device application.
      8          
      9          
     10            Copyright 2006-2009 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, 
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com. 
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42            This device will be like a Light device.  This application is not
     43            intended to be a Light device, but will use the device description
     44            to implement this sample code.
     45          *********************************************************************/
     46          
     47          /*********************************************************************
     48           * INCLUDES
     49           */
     50          #include "ZComDef.h"
     51          #include "OSAL.h"
     52          #include "AF.h"
     53          #include "ZDApp.h"
     54          
     55          #include "zcl.h"
     56          #include "zcl_general.h"
     57          #include "zcl_ha.h"
     58          
     59          #include "zcl_onofflight.h"
     60          
     61          #include "onboard.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1
     62          
     63          /* HAL */
     64          #include "hal_lcd.h"
     65          #include "hal_led.h"
     66          #include "hal_key.h"
     67          
     68          #include "zcl_light_control.h"
     69          #include "zcl_device_info.h"
     70          
     71          /*********************************************************************
     72           * MACROS
     73           */
     74          
     75          /*********************************************************************
     76           * CONSTANTS
     77           */
     78          /*********************************************************************
     79           * TYPEDEFS
     80           */
     81          
     82          /*********************************************************************
     83           * GLOBAL VARIABLES
     84           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     85          byte zclOnOffLight_TaskID;
   \                     zclOnOffLight_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     86          devStates_t zclDevice_NwkState;
   \                     zclDevice_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     87          uint8 zclDevice_RejoinCounter = 0;
   \                     zclDevice_RejoinCounter:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
     88          int8 zclDevice_JoinNetworkOk = 8;
   \                     zclDevice_JoinNetworkOk:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zclDevice_JoinNetworkOk>`
   \   000001                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     89          int8 zclDevice_InitDone = 0;
   \                     zclDevice_InitDone:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     90          uint8 zcl_Led_Blink = 0;
   \                     zcl_Led_Blink:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     91          endPointDesc_t DeviceApp_epDesc;
   \                     DeviceApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     92          uint8 g_u8JoinNwkOnce = 0;
   \                     g_u8JoinNwkOnce:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     93          uint8 g_u8restFlag = 0;
   \                     g_u8restFlag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     94          uint8 abno_led = 0;
   \                     abno_led:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     95          uint8 flashledflag = 0;
   \                     flashledflag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     96          uint8 valu = 0;
   \                     valu:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     97          /*********************************************************************
     98           * GLOBAL FUNCTIONS
     99           */
    100          
    101          /*********************************************************************
    102           * LOCAL VARIABLES
    103           */
    104          //static afAddrType_t zclOnOffLight_DstAddr;
    105          
    106          /*********************************************************************
    107           * LOCAL FUNCTIONS
    108           */
    109          static void zclOnOffLight_HandleKeys( byte shift, byte keys );
    110          static void zclOnOffLight_BasicResetCB( void );
    111          static void zclOnOffLight_IdentifyCB( zclIdentify_t *pCmd );
    112          static void zclOnOffLight_IdentifyQueryRspCB( zclIdentifyQueryRsp_t *pRsp );
    113          static void zclOnOffLight0_OnOffCB(uint8 cmd );
    114          static void zclOnOffLight1_OnOffCB(uint8 cmd );
    115          static void zclOnOffLight2_OnOffCB(uint8 cmd );
    116          static void zclOnOffLight3_OnOffCB(uint8 cmd );
    117          static void zclOnOffLight_OnOffCB(uint8 light, uint8 cmd );
    118          static void zclOnOffLight_ProcessIdentifyTimeChange( void );
    119          static void PrintfNetState( devStates_t NwkState );
    120          
    121          // Functions to process ZCL Foundation incoming Command/Response messages 
    122          static void zclOnOffLight_ProcessIncomingMsg( zclIncomingMsg_t *msg );
    123          #ifdef ZCL_READ
    124          static uint8 zclOnOffLight_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg );
    125          #endif
    126          #ifdef ZCL_WRITE
    127          static uint8 zclOnOffLight_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg );
    128          #endif
    129          static uint8 zclOnOffLight_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg );
    130          #ifdef ZCL_DISCOVER
    131          static uint8 zclOnOffLight_ProcessInDiscRspCmd( zclIncomingMsg_t *pInMsg );
    132          #endif
    133          
    134          /*********************************************************************
    135           * ZCL General Profile Callback table
    136           */

   \                                 In  segment XDATA_I, align 1, keep-with-next
    137          static zclGeneral_AppCallbacks_t zclOnOffLight0_CmdCallbacks =
   \                     zclOnOffLight0_CmdCallbacks:
   \   000000                DS 30
   \   00001E                REQUIRE `?<Initializer for zclOnOffLight0_CmdCallbacks>`
   \   00001E                REQUIRE __INIT_XDATA_I
    138          {
    139            zclOnOffLight_BasicResetCB,              // Basic Cluster Reset command
    140            zclOnOffLight_IdentifyCB,                // Identify command  
    141            zclOnOffLight_IdentifyQueryRspCB,        // Identify Query Response command
    142            zclOnOffLight0_OnOffCB,                   // On/Off cluster command
    143            NULL,                                     // Level Control Move to Level command
    144            NULL,                                     // Level Control Move command
    145            NULL,                                     // Level Control Step command
    146            NULL,                                     // Group Response commands
    147            NULL,                                     // Scene Store Request command
    148            NULL,                                     // Scene Recall Request command
    149            NULL,                                     // Scene Response command
    150            NULL,                                     // Alarm (Response) command
    151            NULL,                                     // RSSI Location commands
    152            NULL,                                     // RSSI Location Response commands
    153          };

   \                                 In  segment XDATA_I, align 1, keep-with-next
    154          static zclGeneral_AppCallbacks_t zclOnOffLight1_CmdCallbacks =
   \                     zclOnOffLight1_CmdCallbacks:
   \   000000                DS 30
   \   00001E                REQUIRE `?<Initializer for zclOnOffLight1_CmdCallbacks>`
   \   00001E                REQUIRE __INIT_XDATA_I
    155          {
    156            zclOnOffLight_BasicResetCB,              // Basic Cluster Reset command
    157            zclOnOffLight_IdentifyCB,                // Identify command  
    158            zclOnOffLight_IdentifyQueryRspCB,        // Identify Query Response command
    159            zclOnOffLight1_OnOffCB,                   // On/Off cluster command
    160            NULL,                                     // Level Control Move to Level command
    161            NULL,                                     // Level Control Move command
    162            NULL,                                     // Level Control Step command
    163            NULL,                                     // Group Response commands
    164            NULL,                                     // Scene Store Request command
    165            NULL,                                     // Scene Recall Request command
    166            NULL,                                     // Scene Response command
    167            NULL,                                     // Alarm (Response) command
    168            NULL,                                     // RSSI Location commands
    169            NULL,                                     // RSSI Location Response commands
    170          };

   \                                 In  segment XDATA_I, align 1, keep-with-next
    171          static zclGeneral_AppCallbacks_t zclOnOffLight2_CmdCallbacks =
   \                     zclOnOffLight2_CmdCallbacks:
   \   000000                DS 30
   \   00001E                REQUIRE `?<Initializer for zclOnOffLight2_CmdCallbacks>`
   \   00001E                REQUIRE __INIT_XDATA_I
    172          {
    173            zclOnOffLight_BasicResetCB,              // Basic Cluster Reset command
    174            zclOnOffLight_IdentifyCB,                // Identify command  
    175            zclOnOffLight_IdentifyQueryRspCB,        // Identify Query Response command
    176            zclOnOffLight2_OnOffCB,                   // On/Off cluster command
    177            NULL,                                     // Level Control Move to Level command
    178            NULL,                                     // Level Control Move command
    179            NULL,                                     // Level Control Step command
    180            NULL,                                     // Group Response commands
    181            NULL,                                     // Scene Store Request command
    182            NULL,                                     // Scene Recall Request command
    183            NULL,                                     // Scene Response command
    184            NULL,                                     // Alarm (Response) command
    185            NULL,                                     // RSSI Location commands
    186            NULL,                                     // RSSI Location Response commands

   \                                 In  segment XDATA_I, align 1, keep-with-next
    187          };static zclGeneral_AppCallbacks_t zclOnOffLight3_CmdCallbacks =
   \                     zclOnOffLight3_CmdCallbacks:
   \   000000                DS 30
   \   00001E                REQUIRE `?<Initializer for zclOnOffLight3_CmdCallbacks>`
   \   00001E                REQUIRE __INIT_XDATA_I
    188          {
    189            zclOnOffLight_BasicResetCB,              // Basic Cluster Reset command
    190            zclOnOffLight_IdentifyCB,                // Identify command  
    191            zclOnOffLight_IdentifyQueryRspCB,        // Identify Query Response command
    192            zclOnOffLight3_OnOffCB,                   // On/Off cluster command
    193            NULL,                                     // Level Control Move to Level command
    194            NULL,                                     // Level Control Move command
    195            NULL,                                     // Level Control Step command
    196            NULL,                                     // Group Response commands
    197            NULL,                                     // Scene Store Request command
    198            NULL,                                     // Scene Recall Request command
    199            NULL,                                     // Scene Response command
    200            NULL,                                     // Alarm (Response) command
    201            NULL,                                     // RSSI Location commands
    202            NULL,                                     // RSSI Location Response commands
    203          };
    204          /*********************************************************************
    205           * @fn          zclOnOffLight_Init
    206           *
    207           * @brief       Initialization function for the zclGeneral layer.
    208           *
    209           * @param       none
    210           *
    211           * @return      none
    212           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    213          void zclOnOffLight_Init( byte task_id )
   \                     zclOnOffLight_Init:
    214          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    215            zclOnOffLight_TaskID = task_id;
   \   000006   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   000009   F0           MOVX    @DPTR,A
    216            zclDevice_JoinNetworkOk = 6;
   \   00000A   90....       MOV     DPTR,#zclDevice_JoinNetworkOk
   \   00000D   7406         MOV     A,#0x6
   \   00000F   F0           MOVX    @DPTR,A
    217            zclDevice_NwkState = DEV_INIT;
   \   000010   90....       MOV     DPTR,#zclDevice_NwkState
   \   000013   7401         MOV     A,#0x1
   \   000015   F0           MOVX    @DPTR,A
    218            zclDevice_InitDone = 0;
   \   000016   90....       MOV     DPTR,#zclDevice_InitDone
   \   000019   E4           CLR     A
   \   00001A   F0           MOVX    @DPTR,A
    219            zclDevice_RejoinCounter = 0;
   \   00001B   90....       MOV     DPTR,#zclDevice_RejoinCounter
   \   00001E   F0           MOVX    @DPTR,A
    220            // Set destination address to indirect
    221            //zclOnOffLight_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
    222            //zclOnOffLight_DstAddr.endPoint = 0;
    223            //zclOnOffLight_DstAddr.addr.shortAddr = 0;
    224              
    225            DeviceApp_epDesc.endPoint = 0xF0;
   \   00001F   90....       MOV     DPTR,#DeviceApp_epDesc
   \   000022   74F0         MOV     A,#-0x10
   \   000024   F0           MOVX    @DPTR,A
    226            DeviceApp_epDesc.task_id = &zclOnOffLight_TaskID;
   \   000025   A3           INC     DPTR
   \   000026   74..         MOV     A,#zclOnOffLight_TaskID & 0xff
   \   000028   F0           MOVX    @DPTR,A
   \   000029   A3           INC     DPTR
   \   00002A   74..         MOV     A,#(zclOnOffLight_TaskID >> 8) & 0xff
   \   00002C   F0           MOVX    @DPTR,A
    227            DeviceApp_epDesc.simpleDesc
    228                      = (SimpleDescriptionFormat_t *)&zclOnOffLight0_SimpleDesc;
   \   00002D   A3           INC     DPTR
   \   00002E   74..         MOV     A,#zclOnOffLight0_SimpleDesc & 0xff
   \   000030   F0           MOVX    @DPTR,A
   \   000031   A3           INC     DPTR
   \   000032   74..         MOV     A,#(zclOnOffLight0_SimpleDesc >> 8) & 0xff
   \   000034   F0           MOVX    @DPTR,A
    229            DeviceApp_epDesc.latencyReq = noLatencyReqs;
   \   000035   A3           INC     DPTR
   \   000036   E4           CLR     A
   \   000037   F0           MOVX    @DPTR,A
    230          
    231            // Register the endpoint description with the AF
    232            afRegister( &DeviceApp_epDesc );
   \   000038                ; Setup parameters for call to function afRegister
   \   000038   7A..         MOV     R2,#DeviceApp_epDesc & 0xff
   \   00003A   7B..         MOV     R3,#(DeviceApp_epDesc >> 8) & 0xff
   \   00003C   12....       LCALL   ??afRegister?relay
    233          
    234            // This app is part of the Home Automation Profile
    235            zclHA_Init( &zclOnOffLight0_SimpleDesc );
   \   00003F                ; Setup parameters for call to function zclHA_Init
   \   00003F   7A..         MOV     R2,#zclOnOffLight0_SimpleDesc & 0xff
   \   000041   7B..         MOV     R3,#(zclOnOffLight0_SimpleDesc >> 8) & 0xff
   \   000043   12....       LCALL   ??zclHA_Init?relay
    236            zclHA_Init( &zclOnOffLight1_SimpleDesc );
   \   000046                ; Setup parameters for call to function zclHA_Init
   \   000046   7A..         MOV     R2,#zclOnOffLight1_SimpleDesc & 0xff
   \   000048   7B..         MOV     R3,#(zclOnOffLight1_SimpleDesc >> 8) & 0xff
   \   00004A   12....       LCALL   ??zclHA_Init?relay
    237            zclHA_Init( &zclOnOffLight2_SimpleDesc );
   \   00004D                ; Setup parameters for call to function zclHA_Init
   \   00004D   7A..         MOV     R2,#zclOnOffLight2_SimpleDesc & 0xff
   \   00004F   7B..         MOV     R3,#(zclOnOffLight2_SimpleDesc >> 8) & 0xff
   \   000051   12....       LCALL   ??zclHA_Init?relay
    238            zclHA_Init( &zclOnOffLight3_SimpleDesc );
   \   000054                ; Setup parameters for call to function zclHA_Init
   \   000054   7A..         MOV     R2,#zclOnOffLight3_SimpleDesc & 0xff
   \   000056   7B..         MOV     R3,#(zclOnOffLight3_SimpleDesc >> 8) & 0xff
   \   000058   12....       LCALL   ??zclHA_Init?relay
    239          
    240            // Register the ZCL General Cluster Library callback functions
    241            zclGeneral_RegisterCmdCallbacks( ONOFFLIGHT0_ENDPOINT, &zclOnOffLight0_CmdCallbacks );
   \   00005B                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   00005B   7A..         MOV     R2,#zclOnOffLight0_CmdCallbacks & 0xff
   \   00005D   7B..         MOV     R3,#(zclOnOffLight0_CmdCallbacks >> 8) & 0xff
   \   00005F   7910         MOV     R1,#0x10
   \   000061   12....       LCALL   ??zclGeneral_RegisterCmdCallbacks?relay
    242            zclGeneral_RegisterCmdCallbacks( ONOFFLIGHT1_ENDPOINT, &zclOnOffLight1_CmdCallbacks );
   \   000064                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   000064   7A..         MOV     R2,#zclOnOffLight1_CmdCallbacks & 0xff
   \   000066   7B..         MOV     R3,#(zclOnOffLight1_CmdCallbacks >> 8) & 0xff
   \   000068   7911         MOV     R1,#0x11
   \   00006A   12....       LCALL   ??zclGeneral_RegisterCmdCallbacks?relay
    243            zclGeneral_RegisterCmdCallbacks( ONOFFLIGHT2_ENDPOINT, &zclOnOffLight2_CmdCallbacks );
   \   00006D                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   00006D   7A..         MOV     R2,#zclOnOffLight2_CmdCallbacks & 0xff
   \   00006F   7B..         MOV     R3,#(zclOnOffLight2_CmdCallbacks >> 8) & 0xff
   \   000071   7912         MOV     R1,#0x12
   \   000073   12....       LCALL   ??zclGeneral_RegisterCmdCallbacks?relay
    244            zclGeneral_RegisterCmdCallbacks( ONOFFLIGHT3_ENDPOINT, &zclOnOffLight3_CmdCallbacks );
   \   000076                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   000076   7A..         MOV     R2,#zclOnOffLight3_CmdCallbacks & 0xff
   \   000078   7B..         MOV     R3,#(zclOnOffLight3_CmdCallbacks >> 8) & 0xff
   \   00007A   7913         MOV     R1,#0x13
   \   00007C   12....       LCALL   ??zclGeneral_RegisterCmdCallbacks?relay
    245            
    246            // Register the application's attribute list
    247            zcl_registerAttrList( ONOFFLIGHT0_ENDPOINT, ONOFFLIGHT_MAX_ATTRIBUTES, zclOnOffLight0_Attrs );
   \   00007F                ; Setup parameters for call to function zcl_registerAttrList
   \   00007F   7C..         MOV     R4,#zclOnOffLight0_Attrs & 0xff
   \   000081   7D..         MOV     R5,#(zclOnOffLight0_Attrs >> 8) & 0xff
   \   000083   7A0C         MOV     R2,#0xc
   \   000085   7910         MOV     R1,#0x10
   \   000087   12....       LCALL   ??zcl_registerAttrList?relay
    248            zcl_registerAttrList( ONOFFLIGHT1_ENDPOINT, ONOFFLIGHT_MAX_ATTRIBUTES, zclOnOffLight1_Attrs );  
   \   00008A                ; Setup parameters for call to function zcl_registerAttrList
   \   00008A   7C..         MOV     R4,#zclOnOffLight1_Attrs & 0xff
   \   00008C   7D..         MOV     R5,#(zclOnOffLight1_Attrs >> 8) & 0xff
   \   00008E   7A0C         MOV     R2,#0xc
   \   000090   7911         MOV     R1,#0x11
   \   000092   12....       LCALL   ??zcl_registerAttrList?relay
    249            zcl_registerAttrList( ONOFFLIGHT2_ENDPOINT, ONOFFLIGHT_MAX_ATTRIBUTES, zclOnOffLight2_Attrs );  
   \   000095                ; Setup parameters for call to function zcl_registerAttrList
   \   000095   7C..         MOV     R4,#zclOnOffLight2_Attrs & 0xff
   \   000097   7D..         MOV     R5,#(zclOnOffLight2_Attrs >> 8) & 0xff
   \   000099   7A0C         MOV     R2,#0xc
   \   00009B   7912         MOV     R1,#0x12
   \   00009D   12....       LCALL   ??zcl_registerAttrList?relay
    250            zcl_registerAttrList( ONOFFLIGHT3_ENDPOINT, ONOFFLIGHT_MAX_ATTRIBUTES, zclOnOffLight3_Attrs );  
   \   0000A0                ; Setup parameters for call to function zcl_registerAttrList
   \   0000A0   7C..         MOV     R4,#zclOnOffLight3_Attrs & 0xff
   \   0000A2   7D..         MOV     R5,#(zclOnOffLight3_Attrs >> 8) & 0xff
   \   0000A4   7A0C         MOV     R2,#0xc
   \   0000A6   7913         MOV     R1,#0x13
   \   0000A8   12....       LCALL   ??zcl_registerAttrList?relay
    251            
    252            // Register the Application to receive the unprocessed Foundation command/response messages
    253            zcl_registerForMsg( zclOnOffLight_TaskID );
   \   0000AB                ; Setup parameters for call to function zcl_registerForMsg
   \   0000AB   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   F9           MOV     R1,A
   \   0000B0   12....       LCALL   ??zcl_registerForMsg?relay
    254            
    255            // Register for all key events - This app will handle all key events
    256            RegisterForKeys( zclOnOffLight_TaskID );
   \   0000B3                ; Setup parameters for call to function RegisterForKeys
   \   0000B3   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   0000B6   E0           MOVX    A,@DPTR
   \   0000B7   F9           MOV     R1,A
   \   0000B8   12....       LCALL   ??RegisterForKeys?relay
    257            
    258             
    259            zclDeviceInfoInit();
   \   0000BB                ; Setup parameters for call to function zclDeviceInfoInit
   \   0000BB   12....       LCALL   ??zclDeviceInfoInit?relay
    260            zclLightControlInit();
   \   0000BE                ; Setup parameters for call to function zclLightControlInit
   \   0000BE   12....       LCALL   ??zclLightControlInit?relay
    261          }
   \   0000C1   02....       LJMP    ??Subroutine8_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine8_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    262          
    263          /*********************************************************************
    264           * @fn          zclSample_event_loop
    265           *
    266           * @brief       Event Loop Processor for zclGeneral.
    267           *
    268           * @param       none
    269           *
    270           * @return      none
    271           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    272          uint16 zclOnOffLight_event_loop( uint8 task_id, uint16 events )
   \                     zclOnOffLight_event_loop:
    273          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    274            afIncomingMSGPacket_t *MSGpkt;
    275            
    276            (void)task_id;  // Intentionally unreferenced parameter
    277          
    278            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   703C         JNZ     ??zclOnOffLight_event_loop_0
    279            {
    280              while ( (MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( zclOnOffLight_TaskID )) )
    281              {
    282                switch ( MSGpkt->hdr.event )
    283                {
    284                case AF_INCOMING_MSG_CMD:
    285                  Device_App_MessageMSGCB(MSGpkt);
    286                  break;
    287                case ZCL_INCOMING_MSG:
    288                  // Incoming ZCL Foundation command/response messages
    289                  zclOnOffLight_ProcessIncomingMsg( (zclIncomingMsg_t *)MSGpkt );
    290                  break;
    291                case KEY_CHANGE:
    292                  zclOnOffLight_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    293                  break;
    294                  break;
    295                case ZDO_STATE_CHANGE:
    296                  PrintfNetState(zclDevice_NwkState);
    297                  zclDevice_NwkState = (devStates_t)(MSGpkt->hdr.status);
    298                  if (zclDevice_NwkState == DEV_ROUTER ) {
    299                    NLME_PermitJoiningRequest(0x00);//
    300                    osal_start_timerEx(zclOnOffLight_TaskID, 
    301                                       ZCL_DEVICE_JOIN_NETWORK_OK_EVENT,
    302                                       ZCL_DEVICE_DELAY_TIME);
    303                    zclDevice_RejoinCounter = 0;
    304                    g_u8JoinNwkOnce = 1;
    305                    //abno_led = 0;
    306                    //flashledflag = 1;
    307                  }else{
    308                  valu = osal_start_timerEx(zclOnOffLight_TaskID,
    309                                     ZCL_DEVICE_EXIT_NETWORK_EVENT,
    310                                     2000);
    311                  }
    312                  break;
    313                default:
    314                  break;
    315                }
    316          
    317                // Release the memory
    318                osal_msg_deallocate( (uint8 *)MSGpkt );
    319              }
    320          
    321              // return unprocessed events
    322              return (events ^ SYS_EVENT_MSG);
    323            }
    324            
    325            //  if (events & ZCL_DEVICE_REJOIN_EVENT) {
    326            //    ZDApp_StartJoiningCycle();
    327            //  }
    328            if (events & ZCL_DEVICE_EXIT_NETWORK_EVENT) {
   \   00000D   EF           MOV     A,R7
   \   00000E   5410         ANL     A,#0x10
   \   000010   7003         JNZ     $+5
   \   000012   02....       LJMP    ??CrossCallReturnLabel_10 & 0xFFFF
    329              if( !(zclDevice_NwkState == DEV_ROUTER ) ){
   \   000015   90....       MOV     DPTR,#zclDevice_NwkState
   \   000018   E0           MOVX    A,@DPTR
   \   000019   6407         XRL     A,#0x7
   \   00001B   7003         JNZ     $+5
   \   00001D   02....       LJMP    ??CrossCallReturnLabel_10 & 0xFFFF
    330              abno_led ++;
   \   000020   90....       MOV     DPTR,#abno_led
   \   000023   E0           MOVX    A,@DPTR
   \   000024   04           INC     A
   \   000025   F0           MOVX    @DPTR,A
    331              if((abno_led) % 2 == 0)
   \   000026   A2E0         MOV     C,0xE0 /* A   */.0
   \   000028   5003         JNC     $+5
   \   00002A   02....       LJMP    ??zclOnOffLight_event_loop_1 & 0xFFFF
    332              {
    333                LED_RED_OFF();
   \   00002D   C297         CLR     0x90.7
   \   00002F   02....       LJMP    ??zclOnOffLight_event_loop_2 & 0xFFFF
    334              }else{
   \                     ??zclOnOffLight_event_loop_3:
   \   000032                ; Setup parameters for call to function osal_start_timerEx
   \   000032   7CD0         MOV     R4,#-0x30
   \   000034   7D07         MOV     R5,#0x7
   \   000036   7A00         MOV     R2,#0x0
   \   000038   7B10         MOV     R3,#0x10
   \   00003A   12....       LCALL   ??Subroutine7_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   00003D   E9           MOV     A,R1
   \   00003E   90....       MOV     DPTR,#valu
   \                     ??zclOnOffLight_event_loop_4:
   \   000041   F0           MOVX    @DPTR,A
   \                     ??zclOnOffLight_event_loop_5:
   \   000042                ; Setup parameters for call to function osal_msg_deallocate
   \   000042   AA..         MOV     R2,?V0 + 0
   \   000044   AB..         MOV     R3,?V0 + 1
   \   000046   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??zclOnOffLight_event_loop_0:
   \   000049                ; Setup parameters for call to function osal_msg_receive
   \   000049   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   F9           MOV     R1,A
   \   00004E   12....       LCALL   ??osal_msg_receive?relay
   \   000051   8A..         MOV     ?V0 + 0,R2
   \   000053   8B..         MOV     ?V0 + 1,R3
   \   000055   EA           MOV     A,R2
   \   000056   45..         ORL     A,?V0 + 1
   \   000058   7003         JNZ     $+5
   \   00005A   02....       LJMP    ??zclOnOffLight_event_loop_6 & 0xFFFF
   \   00005D   8A82         MOV     DPL,R2
   \   00005F   8B83         MOV     DPH,R3
   \   000061   E0           MOVX    A,@DPTR
   \   000062   24E6         ADD     A,#-0x1a
   \   000064   600A         JZ      ??zclOnOffLight_event_loop_7
   \   000066   24E6         ADD     A,#-0x1a
   \   000068   600B         JZ      ??zclOnOffLight_event_loop_8
   \   00006A   2463         ADD     A,#0x63
   \   00006C   603E         JZ      ??zclOnOffLight_event_loop_9
   \   00006E   80D2         SJMP    ??zclOnOffLight_event_loop_5
   \                     ??zclOnOffLight_event_loop_7:
   \   000070                ; Setup parameters for call to function Device_App_MessageMSGCB
   \   000070   12....       LCALL   ??Device_App_MessageMSGCB?relay
   \   000073   80CD         SJMP    ??zclOnOffLight_event_loop_5
   \                     ??zclOnOffLight_event_loop_8:
   \   000075   A3           INC     DPTR
   \   000076   A3           INC     DPTR
   \   000077   A3           INC     DPTR
   \   000078   A3           INC     DPTR
   \   000079   A3           INC     DPTR
   \   00007A   A3           INC     DPTR
   \   00007B   A3           INC     DPTR
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   14           DEC     A
   \   00007E   6011         JZ      ??zclOnOffLight_event_loop_10
   \   000080   24FD         ADD     A,#-0x3
   \   000082   7018         JNZ     ??zclOnOffLight_event_loop_11
   \   000084   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   000087   6013         JZ      ??zclOnOffLight_event_loop_11
   \                     ??zclOnOffLight_event_loop_12:
   \   000089   08           INC     R0
   \   00008A   E8           MOV     A,R0
   \   00008B   C3           CLR     C
   \   00008C   99           SUBB    A,R1
   \   00008D   500D         JNC     ??zclOnOffLight_event_loop_11
   \   00008F   80F8         SJMP    ??zclOnOffLight_event_loop_12
   \                     ??zclOnOffLight_event_loop_10:
   \   000091   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   000094   6006         JZ      ??zclOnOffLight_event_loop_11
   \                     ??zclOnOffLight_event_loop_13:
   \   000096   08           INC     R0
   \   000097   E8           MOV     A,R0
   \   000098   C3           CLR     C
   \   000099   99           SUBB    A,R1
   \   00009A   40FA         JC      ??zclOnOffLight_event_loop_13
   \                     ??zclOnOffLight_event_loop_11:
   \   00009C   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   00009F   FA           MOV     R2,A
   \   0000A0   A3           INC     DPTR
   \   0000A1   E0           MOVX    A,@DPTR
   \   0000A2   FB           MOV     R3,A
   \   0000A3   EA           MOV     A,R2
   \   0000A4   4B           ORL     A,R3
   \   0000A5   609B         JZ      ??zclOnOffLight_event_loop_5
   \   0000A7                ; Setup parameters for call to function osal_mem_free
   \   0000A7   12....       LCALL   ??osal_mem_free?relay
   \   0000AA   8096         SJMP    ??zclOnOffLight_event_loop_5
   \                     ??zclOnOffLight_event_loop_9:
   \   0000AC   90....       MOV     DPTR,#zclDevice_NwkState
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   F5..         MOV     ?V0 + 2,A
   \   0000B2   12....       LCALL   ?UC_SWITCH_SPARSE
   \                     `?<Jumptable for zclOnOffLight_event_loop>_0`:
   \   0000B5   01           DB        1
   \   0000B6   00           DB        0
   \   0000B7   0A           DB        10
   \   0000B8   ....         DW        ??zclOnOffLight_event_loop_14
   \   0000BA   00           DB        0
   \   0000BB   ....         DW        ??zclOnOffLight_event_loop_15
   \                     ??zclOnOffLight_event_loop_14:
   \   0000BD                ; Setup parameters for call to function HalUARTWrite
   \   0000BD   7C01         MOV     R4,#0x1
   \   0000BF   7D00         MOV     R5,#0x0
   \   0000C1   AA..         MOV     R2,?V0 + 2
   \   0000C3   7B00         MOV     R3,#0x0
   \   0000C5   7900         MOV     R1,#0x0
   \   0000C7   12....       LCALL   ??HalUARTWrite?relay
   \                     ??zclOnOffLight_event_loop_15:
   \   0000CA   85..82       MOV     DPL,?V0 + 0
   \   0000CD   85..83       MOV     DPH,?V0 + 1
   \   0000D0   A3           INC     DPTR
   \   0000D1   E0           MOVX    A,@DPTR
   \   0000D2   90....       MOV     DPTR,#zclDevice_NwkState
   \   0000D5   F0           MOVX    @DPTR,A
   \   0000D6   6407         XRL     A,#0x7
   \   0000D8   6003         JZ      $+5
   \   0000DA   02....       LJMP    ??zclOnOffLight_event_loop_3 & 0xFFFF
   \   0000DD                ; Setup parameters for call to function NLME_PermitJoiningRequest
   \   0000DD   7900         MOV     R1,#0x0
   \   0000DF   12....       LCALL   ??NLME_PermitJoiningRequest?relay
   \   0000E2                ; Setup parameters for call to function osal_rand
   \   0000E2   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   0000E5   7A02         MOV     R2,#0x2
   \   0000E7   12....       LCALL   ??Subroutine6_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   0000EA   90....       MOV     DPTR,#zclDevice_RejoinCounter
   \   0000ED   E4           CLR     A
   \   0000EE   F0           MOVX    @DPTR,A
   \   0000EF   90....       MOV     DPTR,#g_u8JoinNwkOnce
   \   0000F2   04           INC     A
   \   0000F3   02....       LJMP    ??zclOnOffLight_event_loop_4 & 0xFFFF
   \                     ??zclOnOffLight_event_loop_6:
   \   0000F6   EE           MOV     A,R6
   \   0000F7   FA           MOV     R2,A
   \   0000F8   EF           MOV     A,R7
   \   0000F9   6480         XRL     A,#0x80
   \   0000FB   FB           MOV     R3,A
   \   0000FC   02....       LJMP    ??zclOnOffLight_event_loop_16 & 0xFFFF
    335                LED_RED_ON();
   \                     ??zclOnOffLight_event_loop_1:
   \   0000FF   D297         SETB    0x90.7
    336              }
    337              
    338              if(abno_led >= 255)
   \                     ??zclOnOffLight_event_loop_2:
   \   000101   F4           CPL     A
   \   000102   7002         JNZ     ??zclOnOffLight_event_loop_17
    339                abno_led = 0;
   \   000104   E4           CLR     A
   \   000105   F0           MOVX    @DPTR,A
    340              osal_start_timerEx(zclOnOffLight_TaskID, 
    341                                 ZCL_DEVICE_EXIT_NETWORK_EVENT,
    342                                 2000);
   \                     ??zclOnOffLight_event_loop_17:
   \   000106                ; Setup parameters for call to function osal_start_timerEx
   \   000106   7CD0         MOV     R4,#-0x30
   \   000108   7D07         MOV     R5,#0x7
   \   00010A   7A00         MOV     R2,#0x0
   \   00010C   7B10         MOV     R3,#0x10
   \   00010E   12....       LCALL   ??Subroutine7_0 & 0xFFFF
    343              }
    344            }
    345            
    346            if ( events & ONOFFLIGHT_IDENTIFY_TIMEOUT_EVT )
   \                     ??CrossCallReturnLabel_10:
   \   000111   EE           MOV     A,R6
   \   000112   A2E0         MOV     C,0xE0 /* A   */.0
   \   000114   502F         JNC     ??zclOnOffLight_event_loop_18
    347            {
    348              if ( zclOnOffLight_IdentifyTime > 0 )
   \   000116   90....       MOV     DPTR,#zclOnOffLight_IdentifyTime
   \   000119   E0           MOVX    A,@DPTR
   \   00011A   F8           MOV     R0,A
   \   00011B   A3           INC     DPTR
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   F9           MOV     R1,A
   \   00011E   E8           MOV     A,R0
   \   00011F   49           ORL     A,R1
   \   000120   6017         JZ      ??zclOnOffLight_event_loop_19
    349                zclOnOffLight_IdentifyTime--;
   \   000122   90....       MOV     DPTR,#zclOnOffLight_IdentifyTime
   \   000125   E0           MOVX    A,@DPTR
   \   000126   24FF         ADD     A,#-0x1
   \   000128   F0           MOVX    @DPTR,A
   \   000129   A3           INC     DPTR
   \   00012A   E0           MOVX    A,@DPTR
   \   00012B   34FF         ADDC    A,#-0x1
   \   00012D   F0           MOVX    @DPTR,A
    350              zclOnOffLight_ProcessIdentifyTimeChange();
   \   00012E   18           DEC     R0
   \   00012F   F9           MOV     R1,A
   \   000130   E8           MOV     A,R0
   \   000131   49           ORL     A,R1
   \   000132   6005         JZ      ??zclOnOffLight_event_loop_19
   \   000134                ; Setup parameters for call to function osal_start_timerEx
   \   000134   12....       LCALL   ?Subroutine2 & 0xFFFF
    351              
    352              //return ( events ^ ONOFFLIGHT_IDENTIFY_TIMEOUT_EVT );
    353            }
   \                     ??CrossCallReturnLabel_13:
   \   000137   800C         SJMP    ??zclOnOffLight_event_loop_18
   \                     ??zclOnOffLight_event_loop_19:
   \   000139                ; Setup parameters for call to function osal_stop_timerEx
   \   000139   7A01         MOV     R2,#0x1
   \   00013B   7B00         MOV     R3,#0x0
   \   00013D   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   000140   E0           MOVX    A,@DPTR
   \   000141   F9           MOV     R1,A
   \   000142   12....       LCALL   ??osal_stop_timerEx?relay
    354            
    355            if (events & ZCL_DEVICE_INIT_DONE_EVENT) {
   \                     ??zclOnOffLight_event_loop_18:
   \   000145   EE           MOV     A,R6
   \   000146   5408         ANL     A,#0x8
   \   000148   600B         JZ      ??zclOnOffLight_event_loop_20
    356              zclDevice_InitDone = 1;
   \   00014A   90....       MOV     DPTR,#zclDevice_InitDone
   \   00014D   7401         MOV     A,#0x1
   \   00014F   F0           MOVX    @DPTR,A
    357              LED_RED_OFF();
   \   000150   C297         CLR     0x90.7
    358              zclLightControlTouchPanelEnable();
   \   000152                ; Setup parameters for call to function zclLightControlTouchPanelEnable
   \   000152   12....       LCALL   ??zclLightControlTouchPanelEnable?relay
    359              
    360          //    if( !(zclDevice_NwkState == DEV_ROUTER ) ){
    361          //              osal_start_timerEx(zclOnOffLight_TaskID,
    362          //                           ZCL_DEVICE_EXIT_NETWORK_EVENT,
    363          //                           10000);
    364          //    }
    365              
    366              //return (events ^ ZCL_DEVICE_INIT_DONE_EVENT);
    367            }
    368            if (events & ZCL_DEVICE_JOIN_NETWORK_OK_EVENT) {
   \                     ??zclOnOffLight_event_loop_20:
   \   000155   EE           MOV     A,R6
   \   000156   5402         ANL     A,#0x2
   \   000158   6040         JZ      ??CrossCallReturnLabel_11
    369              if (zclDevice_JoinNetworkOk-- % 2) {
   \   00015A   90....       MOV     DPTR,#zclDevice_JoinNetworkOk
   \   00015D   E0           MOVX    A,@DPTR
   \   00015E   75F002       MOV     B,#0x2
   \   000161   12....       LCALL   ?SC_DIV_MOD
   \   000164   E5F0         MOV     A,B
   \   000166   6007         JZ      ??zclOnOffLight_event_loop_21
   \   000168   E0           MOVX    A,@DPTR
   \   000169   14           DEC     A
   \   00016A   F0           MOVX    @DPTR,A
    370               LED_RED_OFF();
   \   00016B   C297         CLR     0x90.7
   \   00016D   8005         SJMP    ??zclOnOffLight_event_loop_22
    371              } else {
   \                     ??zclOnOffLight_event_loop_21:
   \   00016F   E0           MOVX    A,@DPTR
   \   000170   14           DEC     A
   \   000171   F0           MOVX    @DPTR,A
    372                LED_RED_ON();
   \   000172   D297         SETB    0x90.7
    373              }
    374              
    375              if (zclDevice_JoinNetworkOk <= 0) {
   \                     ??zclOnOffLight_event_loop_22:
   \   000174   E0           MOVX    A,@DPTR
   \   000175   9401         SUBB    A,#0x1
   \   000177   A2D2         MOV     C,0xD0 /* PSW */.2
   \   000179   65D0         XRL     A,PSW
   \   00017B   33           RLC     A
   \   00017C   5011         JNC     ??zclOnOffLight_event_loop_23
    376                if (zclDevice_InitDone)  {
   \   00017E   90....       MOV     DPTR,#zclDevice_InitDone
   \   000181   E0           MOVX    A,@DPTR
   \   000182   7002         JNZ     ??zclOnOffLight_event_loop_24
    377                } else {
    378                  LED_RED_ON();
   \   000184   D297         SETB    0x90.7
    379                }
    380                osal_start_timerEx(zclOnOffLight_TaskID, 
    381                               ZCL_DEVICE_INFO_SEND_EVENT,
    382                               ZCL_DEVICE_DELAY_TIME);
   \                     ??zclOnOffLight_event_loop_24:
   \   000186                ; Setup parameters for call to function osal_rand
   \   000186   12....       LCALL   ?Subroutine4 & 0xFFFF
    383              } else {
   \                     ??CrossCallReturnLabel_3:
   \   000189   7A00         MOV     R2,#0x0
   \   00018B   7B01         MOV     R3,#0x1
   \   00018D   8008         SJMP    ??zclOnOffLight_event_loop_25
    384                osal_start_timerEx(zclOnOffLight_TaskID, 
    385                                   ZCL_DEVICE_JOIN_NETWORK_OK_EVENT,
    386                                   500);
   \                     ??zclOnOffLight_event_loop_23:
   \   00018F                ; Setup parameters for call to function osal_start_timerEx
   \   00018F   7CF4         MOV     R4,#-0xc
   \   000191   7D01         MOV     R5,#0x1
   \   000193   7A02         MOV     R2,#0x2
   \   000195   7B00         MOV     R3,#0x0
    387              }
    388            }
   \                     ??zclOnOffLight_event_loop_25:
   \   000197   12....       LCALL   ??Subroutine7_0 & 0xFFFF
    389            
    390            if (events & ZCL_DEVICE_INFO_SEND_EVENT) {
   \                     ??CrossCallReturnLabel_11:
   \   00019A   EF           MOV     A,R7
   \   00019B   5401         ANL     A,#0x1
   \   00019D   6003         JZ      ??zclOnOffLight_event_loop_26
    391              zclSendDeviceInfo();
   \   00019F                ; Setup parameters for call to function zclSendDeviceInfo
   \   00019F   12....       LCALL   ??zclSendDeviceInfo?relay
    392            }
    393            
    394            if (events & ZCL_DEVICE_HEARTBEAT_EVENT) {
   \                     ??zclOnOffLight_event_loop_26:
   \   0001A2   EF           MOV     A,R7
   \   0001A3   5402         ANL     A,#0x2
   \   0001A5   6003         JZ      ??zclOnOffLight_event_loop_27
    395              zclSendHeartbeat();
   \   0001A7                ; Setup parameters for call to function zclSendHeartbeat
   \   0001A7   12....       LCALL   ??zclSendHeartbeat?relay
    396          
    397            }
    398            
    399            if (events & ZCL_DEVICE_TOUCHPANEL_EVENT) {
   \                     ??zclOnOffLight_event_loop_27:
   \   0001AA   EE           MOV     A,R6
   \   0001AB   5410         ANL     A,#0x10
   \   0001AD   6017         JZ      ??CrossCallReturnLabel_12
    400              zclTouchPanelEvent();
   \   0001AF                ; Setup parameters for call to function zclTouchPanelEvent
   \   0001AF   12....       LCALL   ??zclTouchPanelEvent?relay
    401              if(g_u8restFlag == 0)
   \   0001B2   90....       MOV     DPTR,#g_u8restFlag
   \   0001B5   E0           MOVX    A,@DPTR
   \   0001B6   700E         JNZ     ??CrossCallReturnLabel_12
    402              {
    403                g_u8restFlag = 1;
   \   0001B8   7401         MOV     A,#0x1
   \   0001BA   F0           MOVX    @DPTR,A
    404                osal_start_timerEx(zclOnOffLight_TaskID, 
    405                                   ZCL_DEVICE_RESET_EVENT,
    406                                   3000);
   \   0001BB                ; Setup parameters for call to function osal_start_timerEx
   \   0001BB   7CB8         MOV     R4,#-0x48
   \   0001BD   7D0B         MOV     R5,#0xb
   \   0001BF   7A00         MOV     R2,#0x0
   \   0001C1   7B04         MOV     R3,#0x4
   \   0001C3   12....       LCALL   ??Subroutine7_0 & 0xFFFF
    407              }
    408              //return (events ^ ZCL_DEVICE_LIGHT0_TOUCHPANEL_EVENT);
    409            }
    410            if (events & ZCL_DEVICE_RESTORE_INTERRUPT_EVENT) {
   \                     ??CrossCallReturnLabel_12:
   \   0001C6   EE           MOV     A,R6
   \   0001C7   5420         ANL     A,#0x20
   \   0001C9   6003         JZ      ??zclOnOffLight_event_loop_28
    411              zclRestoreInterruptEvent();
   \   0001CB                ; Setup parameters for call to function zclRestoreInterruptEvent
   \   0001CB   12....       LCALL   ??zclRestoreInterruptEvent?relay
    412              //return (events ^ ZCL_DEVICE_LIGHT1_TOUCHPANEL_EVENT);
    413            }
    414            
    415            if (events & ZCL_DEVICE_RESET_EVENT) {
   \                     ??zclOnOffLight_event_loop_28:
   \   0001CE   EF           MOV     A,R7
   \   0001CF   5404         ANL     A,#0x4
   \   0001D1   6003         JZ      ??zclOnOffLight_event_loop_29
    416              zclFactoryResetEvent();
   \   0001D3                ; Setup parameters for call to function zclFactoryResetEvent
   \   0001D3   12....       LCALL   ??zclFactoryResetEvent?relay
    417            }
    418            
    419            if(events & ZCL_DEVICE_SOFT_RESTART_EVENT)
   \                     ??zclOnOffLight_event_loop_29:
   \   0001D6   EE           MOV     A,R6
   \   0001D7   5440         ANL     A,#0x40
   \   0001D9   6026         JZ      ??CrossCallReturnLabel_8
    420            {
    421              if(zcl_Led_Blink >= 60)
   \   0001DB   90....       MOV     DPTR,#zcl_Led_Blink
   \   0001DE   E0           MOVX    A,@DPTR
   \   0001DF   C3           CLR     C
   \   0001E0   943C         SUBB    A,#0x3c
   \   0001E2   4007         JC      ??zclOnOffLight_event_loop_30
    422              {
    423                zclFactoryReset(TRUE);
   \   0001E4                ; Setup parameters for call to function zclFactoryReset
   \   0001E4   7901         MOV     R1,#0x1
   \   0001E6   12....       LCALL   ??zclFactoryReset?relay
   \   0001E9   8016         SJMP    ??CrossCallReturnLabel_8
    424              }
    425              else
    426              {
    427                if(zcl_Led_Blink %2 == 0)
   \                     ??zclOnOffLight_event_loop_30:
   \   0001EB   E0           MOVX    A,@DPTR
   \   0001EC   A2E0         MOV     C,0xE0 /* A   */.0
   \   0001EE   4004         JC      ??zclOnOffLight_event_loop_31
    428                {
    429                  LED_RED_OFF();
   \   0001F0   C297         CLR     0x90.7
   \   0001F2   8002         SJMP    ??zclOnOffLight_event_loop_32
    430                } else {
    431                  LED_RED_ON();
   \                     ??zclOnOffLight_event_loop_31:
   \   0001F4   D297         SETB    0x90.7
    432                }
    433                zcl_Led_Blink++;
   \                     ??zclOnOffLight_event_loop_32:
   \   0001F6   04           INC     A
   \   0001F7   F0           MOVX    @DPTR,A
    434                osal_start_timerEx(zclOnOffLight_TaskID, 
    435                                   ZCL_DEVICE_SOFT_RESTART_EVENT,
    436                                   ZCL_FACTORY_RESET_HINT);
   \   0001F8                ; Setup parameters for call to function osal_start_timerEx
   \   0001F8   7CC8         MOV     R4,#-0x38
   \   0001FA   7D00         MOV     R5,#0x0
   \   0001FC   7A40         MOV     R2,#0x40
   \   0001FE   12....       LCALL   ??Subroutine6_0 & 0xFFFF
    437              }
    438            }
    439            
    440            // Discard unknown events
    441            return 0;
   \                     ??CrossCallReturnLabel_8:
   \   000201   7A00         MOV     R2,#0x0
   \   000203   7B00         MOV     R3,#0x0
   \                     ??zclOnOffLight_event_loop_16:
   \   000205   7F04         MOV     R7,#0x4
   \   000207   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00020A                REQUIRE _A_P1
    442          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   12....       LCALL   ??osal_rand?relay
   \   000003                ; Setup parameters for call to function osal_start_timerEx
   \   000003                ; Setup parameters for call to function osal_start_timerEx
   \   000003   EA           MOV     A,R2
   \   000004   F8           MOV     R0,A
   \   000005   EB           MOV     A,R3
   \   000006   540F         ANL     A,#0xf
   \   000008   F9           MOV     R1,A
   \   000009   E8           MOV     A,R0
   \   00000A   24E8         ADD     A,#-0x18
   \   00000C   FC           MOV     R4,A
   \   00000D   E9           MOV     A,R1
   \   00000E   3403         ADDC    A,#0x3
   \   000010   FD           MOV     R5,A
   \   000011   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000003   F8           MOV     R0,A
   \   000004   A3           INC     DPTR
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   8882         MOV     DPL,R0
   \   000009   8983         MOV     DPH,R1
   \   00000B   7800         MOV     R0,#0x0
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   EA           MOV     A,R2
   \   000001   2417         ADD     A,#0x17
   \   000003   F582         MOV     DPL,A
   \   000005   EB           MOV     A,R3
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7CE8         MOV     R4,#-0x18
   \   000002   7D03         MOV     R5,#0x3
   \   000004   7A01         MOV     R2,#0x1
   \   000006                REQUIRE ??Subroutine6_0
   \   000006                ; // Fall through to label ??Subroutine6_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine6_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002                REQUIRE ??Subroutine7_0
   \   000002                ; // Fall through to label ??Subroutine7_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine7_0:
   \   000000   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??osal_start_timerEx?relay
   \   000008   22           RET
    443          
    444          /*********************************************************************
    445           * @fn      zclOnOffLight_HandleKeys
    446           *
    447           * @brief   Handles all key events for this device.
    448           *
    449           * @param   shift - true if in shift/alt.
    450           * @param   keys - bit field for key events. Valid entries:
    451           *                 HAL_KEY_SW_4
    452           *                 HAL_KEY_SW_3
    453           *                 HAL_KEY_SW_2
    454           *                 HAL_KEY_SW_1
    455           *
    456           * @return  none
    457           */
    458          static void zclOnOffLight_HandleKeys( byte shift, byte keys )
    459          {
    460           // zAddrType_t dstAddr;
    461            
    462            (void)shift;  // Intentionally unreferenced parameter
    463          
    464            if ( keys & HAL_KEY_SW_2 )
    465            {
    466            }
    467          
    468            if ( keys & HAL_KEY_SW_3 )
    469            {
    470            }
    471          
    472            if ( keys & HAL_KEY_SW_4 )
    473            {
    474            }
    475          }
    476          
    477          /*********************************************************************
    478           * @fn      zclOnOffLight_ProcessIdentifyTimeChange
    479           *
    480           * @brief   Called to process any change to the IdentifyTime attribute.
    481           *
    482           * @param   none
    483           *
    484           * @return  none
    485           */
    486          static void zclOnOffLight_ProcessIdentifyTimeChange( void )
    487          {
    488            if ( zclOnOffLight_IdentifyTime > 0 )
    489            {
    490              osal_start_timerEx( zclOnOffLight_TaskID, ONOFFLIGHT_IDENTIFY_TIMEOUT_EVT, 1000 );
    491            }
    492            else
    493            {
    494              osal_stop_timerEx( zclOnOffLight_TaskID, ONOFFLIGHT_IDENTIFY_TIMEOUT_EVT );
    495            }
    496          }
    497          
    498          /*********************************************************************
    499           * @fn      zclOnOffLight_BasicResetCB
    500           *
    501           * @brief   Callback from the ZCL General Cluster Library
    502           *          to set all the Basic Cluster attributes to default values.
    503           *
    504           * @param   none
    505           *
    506           * @return  none
    507           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    508          static void zclOnOffLight_BasicResetCB( void )
   \                     zclOnOffLight_BasicResetCB:
    509          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    510            // Reset all attributes to default values
    511          }
   \   000000   02....       LJMP    ?BRET
    512          
    513          /*********************************************************************
    514           * @fn      zclOnOffLight_IdentifyCB
    515           *
    516           * @brief   Callback from the ZCL General Cluster Library when
    517           *          it received an Identity Command for this application.
    518           *
    519           * @param   srcAddr - source address and endpoint of the response message
    520           * @param   identifyTime - the number of seconds to identify yourself
    521           *
    522           * @return  none
    523           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    524          static void zclOnOffLight_IdentifyCB( zclIdentify_t *pCmd )
   \                     zclOnOffLight_IdentifyCB:
    525          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    526            zclOnOffLight_IdentifyTime = pCmd->identifyTime;
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F8           MOV     R0,A
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   90....       MOV     DPTR,#zclOnOffLight_IdentifyTime
   \   000012   E8           MOV     A,R0
   \   000013   F0           MOVX    @DPTR,A
   \   000014   A3           INC     DPTR
   \   000015   E9           MOV     A,R1
   \   000016   F0           MOVX    @DPTR,A
    527            zclOnOffLight_ProcessIdentifyTimeChange();
   \   000017   E8           MOV     A,R0
   \   000018   49           ORL     A,R1
   \   000019   6005         JZ      ??zclOnOffLight_IdentifyCB_0
   \   00001B                ; Setup parameters for call to function osal_start_timerEx
   \   00001B   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   00001E   800C         SJMP    ??zclOnOffLight_IdentifyCB_1
   \                     ??zclOnOffLight_IdentifyCB_0:
   \   000020                ; Setup parameters for call to function osal_stop_timerEx
   \   000020   7A01         MOV     R2,#0x1
   \   000022   7B00         MOV     R3,#0x0
   \   000024   90....       MOV     DPTR,#zclOnOffLight_TaskID
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F9           MOV     R1,A
   \   000029   12....       LCALL   ??osal_stop_timerEx?relay
    528          }
   \                     ??zclOnOffLight_IdentifyCB_1:
   \   00002C                REQUIRE ?Subroutine1
   \   00002C                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    529          
    530          /*********************************************************************
    531           * @fn      zclOnOffLight_IdentifyQueryRspCB
    532           *
    533           * @brief   Callback from the ZCL General Cluster Library when
    534           *          it received an Identity Query Response Command for this application.
    535           *
    536           * @param   srcAddr - requestor's address
    537           * @param   timeout - number of seconds to identify yourself (valid for query response)
    538           *
    539           * @return  none
    540           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    541          static void zclOnOffLight_IdentifyQueryRspCB(  zclIdentifyQueryRsp_t *pRsp )
   \                     zclOnOffLight_IdentifyQueryRspCB:
    542          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    543            // Query Response (with timeout value)
    544            (void)pRsp;
    545          }
   \   000000   02....       LJMP    ?BRET
    546          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    547          static void zclOnOffLight0_OnOffCB(uint8 cmd )
   \                     zclOnOffLight0_OnOffCB:
    548          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    549            zclOnOffLight_OnOffCB(0, cmd);
   \   000006                ; Setup parameters for call to function zclOnOffLight_OnOffCB
   \   000006   FA           MOV     R2,A
   \   000007   7900         MOV     R1,#0x0
   \   000009   80..         SJMP    ?Subroutine0
    550          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ??zclOnOffLight_OnOffCB?relay
   \   000003                REQUIRE ??Subroutine8_0
   \   000003                ; // Fall through to label ??Subroutine8_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    551          static void zclOnOffLight1_OnOffCB(uint8 cmd )
   \                     zclOnOffLight1_OnOffCB:
    552          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    553            zclOnOffLight_OnOffCB(1, cmd);
   \   000006                ; Setup parameters for call to function zclOnOffLight_OnOffCB
   \   000006   FA           MOV     R2,A
   \   000007   7901         MOV     R1,#0x1
   \   000009   80..         SJMP    ?Subroutine0
    554          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    555          static void zclOnOffLight2_OnOffCB(uint8 cmd )
   \                     zclOnOffLight2_OnOffCB:
    556          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    557            zclOnOffLight_OnOffCB(2, cmd);
   \   000006                ; Setup parameters for call to function zclOnOffLight_OnOffCB
   \   000006   FA           MOV     R2,A
   \   000007   7902         MOV     R1,#0x2
   \   000009   80..         SJMP    ?Subroutine0
    558          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    559          static void zclOnOffLight3_OnOffCB(uint8 cmd )
   \                     zclOnOffLight3_OnOffCB:
    560          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    561            zclOnOffLight_OnOffCB(3, cmd);
   \   000006                ; Setup parameters for call to function zclOnOffLight_OnOffCB
   \   000006   FA           MOV     R2,A
   \   000007   7903         MOV     R1,#0x3
   \   000009                REQUIRE ?Subroutine0
   \   000009                ; // Fall through to label ?Subroutine0
    562          }
    563          /*********************************************************************
    564           * @fn      zclOnOffLight_OnOffCB
    565           *
    566           * @brief   Callback from the ZCL General Cluster Library when
    567           *          it received an On/Off Command for this application.
    568           *
    569           * @param   cmd - COMMAND_ON, COMMAND_OFF or COMMAND_TOGGLE
    570           *
    571           * @return  none
    572           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    573          static void zclOnOffLight_OnOffCB(uint8 light, uint8 cmd )
   \                     zclOnOffLight_OnOffCB:
    574          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   \   000008   FF           MOV     R7,A
    575            uint8 *zclOnOffLight_OnOff;
    576            
    577            if (light == 0)
   \   000009   EE           MOV     A,R6
   \   00000A   7008         JNZ     ??zclOnOffLight_OnOffCB_0
    578              zclOnOffLight_OnOff = &zclOnOffLight0_OnOff;
   \   00000C   7582..       MOV     DPL,#zclOnOffLight0_OnOff & 0xff
   \   00000F   7583..       MOV     DPH,#(zclOnOffLight0_OnOff >> 8) & 0xff
   \   000012   8025         SJMP    ??zclOnOffLight_OnOffCB_1
    579            else if(light == 1)
   \                     ??zclOnOffLight_OnOffCB_0:
   \   000014   7401         MOV     A,#0x1
   \   000016   6E           XRL     A,R6
   \   000017   7008         JNZ     ??zclOnOffLight_OnOffCB_2
    580              zclOnOffLight_OnOff = &zclOnOffLight1_OnOff;
   \   000019   7582..       MOV     DPL,#zclOnOffLight1_OnOff & 0xff
   \   00001C   7583..       MOV     DPH,#(zclOnOffLight1_OnOff >> 8) & 0xff
   \   00001F   8018         SJMP    ??zclOnOffLight_OnOffCB_1
    581            else if(light == 2)
   \                     ??zclOnOffLight_OnOffCB_2:
   \   000021   7402         MOV     A,#0x2
   \   000023   6E           XRL     A,R6
   \   000024   7008         JNZ     ??zclOnOffLight_OnOffCB_3
    582             zclOnOffLight_OnOff = &zclOnOffLight2_OnOff;
   \   000026   7582..       MOV     DPL,#zclOnOffLight2_OnOff & 0xff
   \   000029   7583..       MOV     DPH,#(zclOnOffLight2_OnOff >> 8) & 0xff
   \   00002C   800B         SJMP    ??zclOnOffLight_OnOffCB_1
    583            else if(light == 3)
   \                     ??zclOnOffLight_OnOffCB_3:
   \   00002E   7403         MOV     A,#0x3
   \   000030   6E           XRL     A,R6
   \   000031   7006         JNZ     ??zclOnOffLight_OnOffCB_1
    584             zclOnOffLight_OnOff = &zclOnOffLight3_OnOff;
   \   000033   7582..       MOV     DPL,#zclOnOffLight3_OnOff & 0xff
   \   000036   7583..       MOV     DPH,#(zclOnOffLight3_OnOff >> 8) & 0xff
    585            
    586            if ( cmd == COMMAND_ON ) 
   \                     ??zclOnOffLight_OnOffCB_1:
   \   000039   7401         MOV     A,#0x1
   \   00003B   6F           XRL     A,R7
   \   00003C   7010         JNZ     ??zclOnOffLight_OnOffCB_4
    587            {
    588              *zclOnOffLight_OnOff = LIGHT_ON;
   \                     ??zclOnOffLight_OnOffCB_5:
   \   00003E   7401         MOV     A,#0x1
   \   000040   F0           MOVX    @DPTR,A
    589            } else if ( cmd == COMMAND_OFF ) 
    590            {
    591              *zclOnOffLight_OnOff = LIGHT_OFF;
    592            } else 
    593            {
    594              if ( *zclOnOffLight_OnOff == LIGHT_OFF )
    595                *zclOnOffLight_OnOff = LIGHT_ON;
    596              else
    597                *zclOnOffLight_OnOff = LIGHT_OFF;
    598            }
    599            
    600            if ( *zclOnOffLight_OnOff == LIGHT_ON ) 
    601            {
    602              if (light == 0)
   \   000041   EE           MOV     A,R6
   \   000042   701B         JNZ     ??zclOnOffLight_OnOffCB_6
    603                LIGHT_TURN_ON_LIGHT0();
   \   000044   D294         SETB    0x90.4
    604              else if(light == 1)
    605                LIGHT_TURN_ON_LIGHT1();
    606              else if(light == 2)
    607               LIGHT_TURN_ON_LIGHT2();
    608              else if(light == 3)
    609                LIGHT_TURN_ON_LIGHT3();
    610            } else 
    611            {
    612              if (light == 0)
    613                LIGHT_TURN_OFF_LIGHT0();
    614              else if(light == 1)
    615                LIGHT_TURN_OFF_LIGHT1();
    616             else if(light == 2)
    617               LIGHT_TURN_OFF_LIGHT2();
    618              else if(light == 3)
    619                LIGHT_TURN_OFF_LIGHT3();
    620            }
    621            
    622            if (light == 0) {
    623              zclLightReportEvent(ONOFFLIGHT0_ENDPOINT, &zclOnOffLight0_OnOff);
   \                     ??zclOnOffLight_OnOffCB_7:
   \   000046                ; Setup parameters for call to function zclLightReportEvent
   \   000046   7C..         MOV     R4,#zclOnOffLight0_OnOff & 0xff
   \   000048   7D..         MOV     R5,#(zclOnOffLight0_OnOff >> 8) & 0xff
   \   00004A   7A10         MOV     R2,#0x10
   \   00004C   805E         SJMP    ??zclOnOffLight_OnOffCB_8
    624            } else if(light == 1) {
   \                     ??zclOnOffLight_OnOffCB_4:
   \   00004E   EF           MOV     A,R7
   \   00004F   7009         JNZ     ??zclOnOffLight_OnOffCB_9
   \                     ??zclOnOffLight_OnOffCB_10:
   \   000051   E4           CLR     A
   \   000052   F0           MOVX    @DPTR,A
   \   000053   EE           MOV     A,R6
   \   000054   7030         JNZ     ??zclOnOffLight_OnOffCB_11
   \   000056   C294         CLR     0x90.4
   \   000058   80EC         SJMP    ??zclOnOffLight_OnOffCB_7
   \                     ??zclOnOffLight_OnOffCB_9:
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   70F4         JNZ     ??zclOnOffLight_OnOffCB_10
   \   00005D   80DF         SJMP    ??zclOnOffLight_OnOffCB_5
   \                     ??zclOnOffLight_OnOffCB_6:
   \   00005F   7401         MOV     A,#0x1
   \   000061   6E           XRL     A,R6
   \   000062   700A         JNZ     ??zclOnOffLight_OnOffCB_12
   \   000064   D295         SETB    0x90.5
    625              zclLightReportEvent(ONOFFLIGHT1_ENDPOINT, &zclOnOffLight1_OnOff);
   \                     ??zclOnOffLight_OnOffCB_13:
   \   000066                ; Setup parameters for call to function zclLightReportEvent
   \   000066   7C..         MOV     R4,#zclOnOffLight1_OnOff & 0xff
   \   000068   7D..         MOV     R5,#(zclOnOffLight1_OnOff >> 8) & 0xff
   \   00006A   7A11         MOV     R2,#0x11
   \   00006C   803E         SJMP    ??zclOnOffLight_OnOffCB_8
    626            } else if(light == 2){
   \                     ??zclOnOffLight_OnOffCB_12:
   \   00006E   7402         MOV     A,#0x2
   \   000070   6E           XRL     A,R6
   \   000071   700A         JNZ     ??zclOnOffLight_OnOffCB_14
   \   000073   D283         SETB    0x80.3
    627            zclLightReportEvent(ONOFFLIGHT2_ENDPOINT, &zclOnOffLight2_OnOff);
   \                     ??zclOnOffLight_OnOffCB_15:
   \   000075                ; Setup parameters for call to function zclLightReportEvent
   \   000075   7C..         MOV     R4,#zclOnOffLight2_OnOff & 0xff
   \   000077   7D..         MOV     R5,#(zclOnOffLight2_OnOff >> 8) & 0xff
   \   000079   7A12         MOV     R2,#0x12
   \   00007B   802F         SJMP    ??zclOnOffLight_OnOffCB_8
    628            } 
   \                     ??zclOnOffLight_OnOffCB_14:
   \   00007D   7403         MOV     A,#0x3
   \   00007F   6E           XRL     A,R6
   \   000080   701F         JNZ     ??zclOnOffLight_OnOffCB_16
   \   000082   D296         SETB    0x90.6
   \   000084   8020         SJMP    ??zclOnOffLight_OnOffCB_17
   \                     ??zclOnOffLight_OnOffCB_11:
   \   000086   7401         MOV     A,#0x1
   \   000088   6E           XRL     A,R6
   \   000089   7004         JNZ     ??zclOnOffLight_OnOffCB_18
   \   00008B   C295         CLR     0x90.5
   \   00008D   80D7         SJMP    ??zclOnOffLight_OnOffCB_13
   \                     ??zclOnOffLight_OnOffCB_18:
   \   00008F   7402         MOV     A,#0x2
   \   000091   6E           XRL     A,R6
   \   000092   7004         JNZ     ??zclOnOffLight_OnOffCB_19
   \   000094   C283         CLR     0x80.3
   \   000096   80DD         SJMP    ??zclOnOffLight_OnOffCB_15
   \                     ??zclOnOffLight_OnOffCB_19:
   \   000098   7403         MOV     A,#0x3
   \   00009A   6E           XRL     A,R6
   \   00009B   7004         JNZ     ??zclOnOffLight_OnOffCB_16
   \   00009D   C296         CLR     0x90.6
   \   00009F   8005         SJMP    ??zclOnOffLight_OnOffCB_17
    629            else if(light == 3){
   \                     ??zclOnOffLight_OnOffCB_16:
   \   0000A1   7403         MOV     A,#0x3
   \   0000A3   6E           XRL     A,R6
   \   0000A4   700B         JNZ     ??zclOnOffLight_OnOffCB_20
    630              zclLightReportEvent(ONOFFLIGHT3_ENDPOINT, &zclOnOffLight3_OnOff);
   \                     ??zclOnOffLight_OnOffCB_17:
   \   0000A6                ; Setup parameters for call to function zclLightReportEvent
   \   0000A6   7C..         MOV     R4,#zclOnOffLight3_OnOff & 0xff
   \   0000A8   7D..         MOV     R5,#(zclOnOffLight3_OnOff >> 8) & 0xff
   \   0000AA   7A13         MOV     R2,#0x13
   \                     ??zclOnOffLight_OnOffCB_8:
   \   0000AC   7B00         MOV     R3,#0x0
   \   0000AE   12....       LCALL   ??zclLightReportEvent?relay
    631            }
    632          }
   \                     ??zclOnOffLight_OnOffCB_20:
   \   0000B1   02....       LJMP    ??Subroutine8_0 & 0xFFFF
   \   0000B4                REQUIRE _A_P1
   \   0000B4                REQUIRE _A_P0
    633          
    634          
    635          /****************************************************************************** 
    636          * 
    637           *  Functions for processing ZCL Foundation incoming Command/Response messages
    638           *
    639           *****************************************************************************/
    640          
    641          /*********************************************************************
    642           * @fn      zclOnOffLight_ProcessIncomingMsg
    643           *
    644           * @brief   Process ZCL Foundation incoming message
    645           *
    646           * @param   pInMsg - pointer to the received message
    647           *
    648           * @return  none
    649           */
    650          static void zclOnOffLight_ProcessIncomingMsg( zclIncomingMsg_t *pInMsg)
    651          {
    652           
    653            switch ( pInMsg->zclHdr.commandID )
    654            {
    655          #ifdef ZCL_READ
    656              case ZCL_CMD_READ_RSP:
    657                zclOnOffLight_ProcessInReadRspCmd( pInMsg );
    658                break;
    659          #endif
    660          #ifdef ZCL_WRITE    
    661              case ZCL_CMD_WRITE_RSP:
    662                zclOnOffLight_ProcessInWriteRspCmd( pInMsg );
    663                break;
    664          #endif
    665          #ifdef ZCL_REPORT
    666              // See ZCL Test Applicaiton (zcl_testapp.c) for sample code on Attribute Reporting
    667              case ZCL_CMD_CONFIG_REPORT:
    668                //zclOnOffLight_ProcessInConfigReportCmd( pInMsg );
    669                break;
    670              
    671              case ZCL_CMD_CONFIG_REPORT_RSP:
    672                //zclOnOffLight_ProcessInConfigReportRspCmd( pInMsg );
    673                break;
    674              
    675              case ZCL_CMD_READ_REPORT_CFG:
    676                //zclOnOffLight_ProcessInReadReportCfgCmd( pInMsg );
    677                break;
    678              
    679              case ZCL_CMD_READ_REPORT_CFG_RSP:
    680                //zclOnOffLight_ProcessInReadReportCfgRspCmd( pInMsg );
    681                break;
    682              
    683              case ZCL_CMD_REPORT:
    684                //zclOnOffLight_ProcessInReportCmd( pInMsg );
    685                break;
    686          #endif   
    687              case ZCL_CMD_DEFAULT_RSP:
    688                zclOnOffLight_ProcessInDefaultRspCmd( pInMsg );
    689                break;
    690          #ifdef ZCL_DISCOVER     
    691              case ZCL_CMD_DISCOVER_RSP:
    692                zclOnOffLight_ProcessInDiscRspCmd( pInMsg );
    693                break;
    694          #endif  
    695              default:
    696                break;
    697            }
    698            
    699            if ( pInMsg->attrCmd )
    700              osal_mem_free( pInMsg->attrCmd );
    701          }
    702          
    703          #ifdef ZCL_READ
    704          /*********************************************************************
    705           * @fn      zclOnOffLight_ProcessInReadRspCmd
    706           *
    707           * @brief   Process the "Profile" Read Response Command
    708           *
    709           * @param   pInMsg - incoming message to process
    710           *
    711           * @return  none
    712           */
    713          static uint8 zclOnOffLight_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg )
    714          {
    715            zclReadRspCmd_t *readRspCmd;
    716            uint8 i;
    717          
    718            readRspCmd = (zclReadRspCmd_t *)pInMsg->attrCmd;
    719            for (i = 0; i < readRspCmd->numAttr; i++)
    720            {
    721              // Notify the originator of the results of the original read attributes 
    722              // attempt and, for each successfull request, the value of the requested 
    723              // attribute
    724            }
    725          
    726            return TRUE; 
    727          }
    728          #endif // ZCL_READ
    729          
    730          #ifdef ZCL_WRITE
    731          /*********************************************************************
    732           * @fn      zclOnOffLight_ProcessInWriteRspCmd
    733           *
    734           * @brief   Process the "Profile" Write Response Command
    735           *
    736           * @param   pInMsg - incoming message to process
    737           *
    738           * @return  none
    739           */
    740          static uint8 zclOnOffLight_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg )
    741          {
    742            zclWriteRspCmd_t *writeRspCmd;
    743            uint8 i;
    744          
    745            writeRspCmd = (zclWriteRspCmd_t *)pInMsg->attrCmd;
    746            for (i = 0; i < writeRspCmd->numAttr; i++)
    747            {
    748              // Notify the device of the results of the its original write attributes
    749              // command.
    750            }
    751          
    752            return TRUE; 
    753          }
    754          #endif // ZCL_WRITE
    755          
    756          /*********************************************************************
    757           * @fn      zclOnOffLight_ProcessInDefaultRspCmd
    758           *
    759           * @brief   Process the "Profile" Default Response Command
    760           *
    761           * @param   pInMsg - incoming message to process
    762           *
    763           * @return  none
    764           */
    765          static uint8 zclOnOffLight_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg )
    766          {
    767            // zclDefaultRspCmd_t *defaultRspCmd = (zclDefaultRspCmd_t *)pInMsg->attrCmd;
    768             
    769            // Device is notified of the Default Response command.
    770            (void)pInMsg;
    771            
    772            return TRUE; 
    773          }
    774          
    775          #ifdef ZCL_DISCOVER
    776          /*********************************************************************
    777           * @fn      zclOnOffLight_ProcessInDiscRspCmd
    778           *
    779           * @brief   Process the "Profile" Discover Response Command
    780           *
    781           * @param   pInMsg - incoming message to process
    782           *
    783           * @return  none
    784           */
    785          static uint8 zclOnOffLight_ProcessInDiscRspCmd( zclIncomingMsg_t *pInMsg )
    786          {
    787            zclDiscoverRspCmd_t *discoverRspCmd;
    788            uint8 i;
    789            
    790            discoverRspCmd = (zclDiscoverRspCmd_t *)pInMsg->attrCmd;
    791            for ( i = 0; i < discoverRspCmd->numAttr; i++ )
    792            {
    793              // Device is notified of the result of its attribute discovery command.
    794            }
    795            
    796            return TRUE;
    797          }
    798          #endif // ZCL_DISCOVER
    799          
    800          
    801          /****************************************************************************
    802          ****************************************************************************/
    803          
    804          
    805          /***************************************************************************
    806          *****************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    807          void Device_App_MessageMSGCB(afIncomingMSGPacket_t *pkt)
   \                     Device_App_MessageMSGCB:
    808          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    809            switch(pkt->clusterId)
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   7004         JNZ     ??Device_App_MessageMSGCB_0
   \   00000F   A3           INC     DPTR
   \   000010   E0           MOVX    A,@DPTR
   \   000011   6409         XRL     A,#0x9
   \                     ??Device_App_MessageMSGCB_0:
   \   000013   7031         JNZ     ??Device_App_MessageMSGCB_1
    810            {
    811            case ZCL_CLUSTER_ID_PREMIT_JOIN_ZB_NET:
    812              if(pkt->cmd.Data[0] == 0xFF)
   \   000015   EA           MOV     A,R2
   \   000016   2422         ADD     A,#0x22
   \   000018   F8           MOV     R0,A
   \   000019   EB           MOV     A,R3
   \   00001A   3400         ADDC    A,#0x0
   \   00001C   F9           MOV     R1,A
   \   00001D   E8           MOV     A,R0
   \   00001E   FA           MOV     R2,A
   \   00001F   E9           MOV     A,R1
   \   000020   FB           MOV     R3,A
   \   000021   8A82         MOV     DPL,R2
   \   000023   8B83         MOV     DPH,R3
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F8           MOV     R0,A
   \   000027   A3           INC     DPTR
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F9           MOV     R1,A
   \   00002A   8882         MOV     DPL,R0
   \   00002C   8983         MOV     DPH,R1
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F4           CPL     A
   \   000030   7003         JNZ     ??Device_App_MessageMSGCB_2
    813              {
    814                pkt->cmd.Data[0] = 60;
   \   000032   743C         MOV     A,#0x3c
   \   000034   F0           MOVX    @DPTR,A
    815              }
    816              NLME_PermitJoiningRequest(pkt->cmd.Data[0]);
   \                     ??Device_App_MessageMSGCB_2:
   \   000035                ; Setup parameters for call to function NLME_PermitJoiningRequest
   \   000035   8A82         MOV     DPL,R2
   \   000037   8B83         MOV     DPH,R3
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   F8           MOV     R0,A
   \   00003B   A3           INC     DPTR
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   F583         MOV     DPH,A
   \   00003F   8882         MOV     DPL,R0
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F9           MOV     R1,A
   \   000043   12....       LCALL   ??NLME_PermitJoiningRequest?relay
    817              break;
    818              
    819            default:
    820              break;
    821            }
    822          
    823          }
   \                     ??Device_App_MessageMSGCB_1:
   \   000046   02....       LJMP    ?Subroutine1 & 0xFFFF

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclDevice_JoinNetworkOk>`:
   \   000000   08           DB 8

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclOnOffLight0_CmdCallbacks>`:
   \   000000   ....         DW ??zclOnOffLight_BasicResetCB?relay
   \   000002   ....         DW ??zclOnOffLight_IdentifyCB?relay
   \   000004   ....         DW ??zclOnOffLight_IdentifyQueryRspCB?relay
   \   000006   ....         DW ??zclOnOffLight0_OnOffCB?relay
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H
   \   000012   0000         DW 0H
   \   000014   0000         DW 0H
   \   000016   0000         DW 0H
   \   000018   0000         DW 0H
   \   00001A   0000         DW 0H
   \   00001C   0000         DB 0, 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclOnOffLight1_CmdCallbacks>`:
   \   000000   ....         DW ??zclOnOffLight_BasicResetCB?relay
   \   000002   ....         DW ??zclOnOffLight_IdentifyCB?relay
   \   000004   ....         DW ??zclOnOffLight_IdentifyQueryRspCB?relay
   \   000006   ....         DW ??zclOnOffLight1_OnOffCB?relay
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H
   \   000012   0000         DW 0H
   \   000014   0000         DW 0H
   \   000016   0000         DW 0H
   \   000018   0000         DW 0H
   \   00001A   0000         DW 0H
   \   00001C   0000         DB 0, 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclOnOffLight2_CmdCallbacks>`:
   \   000000   ....         DW ??zclOnOffLight_BasicResetCB?relay
   \   000002   ....         DW ??zclOnOffLight_IdentifyCB?relay
   \   000004   ....         DW ??zclOnOffLight_IdentifyQueryRspCB?relay
   \   000006   ....         DW ??zclOnOffLight2_OnOffCB?relay
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H
   \   000012   0000         DW 0H
   \   000014   0000         DW 0H
   \   000016   0000         DW 0H
   \   000018   0000         DW 0H
   \   00001A   0000         DW 0H
   \   00001C   0000         DB 0, 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclOnOffLight3_CmdCallbacks>`:
   \   000000   ....         DW ??zclOnOffLight_BasicResetCB?relay
   \   000002   ....         DW ??zclOnOffLight_IdentifyCB?relay
   \   000004   ....         DW ??zclOnOffLight_IdentifyQueryRspCB?relay
   \   000006   ....         DW ??zclOnOffLight3_OnOffCB?relay
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H
   \   000012   0000         DW 0H
   \   000014   0000         DW 0H
   \   000016   0000         DW 0H
   \   000018   0000         DW 0H
   \   00001A   0000         DW 0H
   \   00001C   0000         DB 0, 0

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight_BasicResetCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight_BasicResetCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight_IdentifyCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight_IdentifyCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight_IdentifyQueryRspCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight_IdentifyQueryRspCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight0_OnOffCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight0_OnOffCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight1_OnOffCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight1_OnOffCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight2_OnOffCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight2_OnOffCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight3_OnOffCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight3_OnOffCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclOnOffLight_OnOffCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclOnOffLight_OnOffCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Device_App_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Device_App_MessageMSGCB
    824          
    825          void PrintfNetState( devStates_t NwkState )
    826          {
    827            switch(NwkState)
    828            {
    829            case DEV_HOLD:
    830              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));//AF
    831              break;
    832            case DEV_INIT:
    833              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    834              break;
    835            case DEV_NWK_DISC:
    836              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    837              break;
    838            case DEV_NWK_JOINING:
    839              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    840              break;
    841            case DEV_NWK_REJOIN:
    842              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    843              break;
    844            case DEV_END_DEVICE_UNAUTH:
    845              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    846              break;
    847            case DEV_END_DEVICE:
    848              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    849              break;
    850            case DEV_ROUTER:
    851              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    852              break;
    853            case DEV_COORD_STARTING:
    854              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    855              break;
    856            case DEV_ZB_COORD:
    857              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    858              break;
    859            case DEV_NWK_ORPHAN:
    860              HalUARTWrite(0,(uint8 *)NwkState,sizeof(NwkState));
    861              break;
    862              
    863            default:
    864              break;
    865            }
    866          }

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     Device_App_MessageMSGCB            2      0     12
       -> NLME_PermitJoiningRequest     4      0      0
     zclOnOffLight0_OnOffCB             0      0      9
       -> zclOnOffLight_OnOffCB         0      0     18
     zclOnOffLight1_OnOffCB             0      0      9
       -> zclOnOffLight_OnOffCB         0      0     18
     zclOnOffLight2_OnOffCB             0      0      9
       -> zclOnOffLight_OnOffCB         0      0     18
     zclOnOffLight3_OnOffCB             0      0      9
       -> zclOnOffLight_OnOffCB         0      0     18
     zclOnOffLight_BasicResetCB         0      0      0
     zclOnOffLight_IdentifyCB           2      0      0
       -> osal_start_timerEx            4      0      0
       -> osal_stop_timerEx             4      0      0
     zclOnOffLight_IdentifyQueryRspCB
                                        0      0      0
     zclOnOffLight_Init                 0      0      9
       -> afRegister                    0      0     18
       -> zclHA_Init                    0      0     18
       -> zclHA_Init                    0      0     18
       -> zclHA_Init                    0      0     18
       -> zclHA_Init                    0      0     18
       -> zclGeneral_RegisterCmdCallbacks
                                        0      0     18
       -> zclGeneral_RegisterCmdCallbacks
                                        0      0     18
       -> zclGeneral_RegisterCmdCallbacks
                                        0      0     18
       -> zclGeneral_RegisterCmdCallbacks
                                        0      0     18
       -> zcl_registerAttrList          0      0     18
       -> zcl_registerAttrList          0      0     18
       -> zcl_registerAttrList          0      0     18
       -> zcl_registerAttrList          0      0     18
       -> zcl_registerForMsg            0      0     18
       -> RegisterForKeys               0      0     18
       -> zclDeviceInfoInit             0      0     18
       -> zclLightControlInit           0      0     18
     zclOnOffLight_OnOffCB              0      0     18
       -> zclLightReportEvent           0      0     18
       -> zclLightReportEvent           0      0     18
       -> zclLightReportEvent           0      0     18
       -> zclLightReportEvent           0      0     18
     zclOnOffLight_event_loop           0      0     12
       -> osal_start_timerEx            0      0     24
       -> osal_msg_deallocate           0      0     24
       -> osal_msg_receive              0      0     24
       -> Device_App_MessageMSGCB       0      0     24
       -> osal_mem_free                 0      0     24
       -> HalUARTWrite                  0      0     24
       -> NLME_PermitJoiningRequest     0      0     24
       -> osal_rand                     0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_stop_timerEx             0      0     24
       -> zclLightControlTouchPanelEnable
                                        0      0     24
       -> osal_rand                     0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_start_timerEx            0      0     24
       -> zclSendDeviceInfo             0      0     24
       -> zclSendHeartbeat              0      0     24
       -> zclTouchPanelEvent            0      0     24
       -> osal_start_timerEx            0      0     24
       -> zclRestoreInterruptEvent      0      0     24
       -> zclFactoryResetEvent          0      0     24
       -> zclFactoryReset               0      0     24
       -> osal_start_timerEx            0      0     24


   Segment part sizes:

     Function/Label                                 Bytes
     --------------                                 -----
     _A_P0                                             1
     _A_P1                                             1
     zclOnOffLight_TaskID                              1
     zclDevice_NwkState                                1
     zclDevice_RejoinCounter                           1
     zclDevice_JoinNetworkOk                           1
     zclDevice_InitDone                                1
     zcl_Led_Blink                                     1
     DeviceApp_epDesc                                  6
     g_u8JoinNwkOnce                                   1
     g_u8restFlag                                      1
     abno_led                                          1
     flashledflag                                      1
     valu                                              1
     zclOnOffLight0_CmdCallbacks                      30
     zclOnOffLight1_CmdCallbacks                      30
     zclOnOffLight2_CmdCallbacks                      30
     zclOnOffLight3_CmdCallbacks                      30
     zclOnOffLight_Init                              196
     ??Subroutine8_0                                   5
     zclOnOffLight_event_loop                        522
     ?Subroutine4                                     18
     ?Subroutine3                                     16
     ?Subroutine5                                     12
     ?Subroutine2                                      6
     ??Subroutine6_0                                   2
     ??Subroutine7_0                                   9
     zclOnOffLight_BasicResetCB                        3
     zclOnOffLight_IdentifyCB                         44
     ?Subroutine1                                      7
     zclOnOffLight_IdentifyQueryRspCB
                                                       3
     zclOnOffLight0_OnOffCB                           11
     ?Subroutine0                                      3
     zclOnOffLight1_OnOffCB                           11
     zclOnOffLight2_OnOffCB                           11
     zclOnOffLight3_OnOffCB                            9
     zclOnOffLight_OnOffCB                           180
     Device_App_MessageMSGCB                          73
     ?<Initializer for zclDevice_JoinNetworkOk>        1
     ?<Initializer for zclOnOffLight0_CmdCallbacks>   30
     ?<Initializer for zclOnOffLight1_CmdCallbacks>   30
     ?<Initializer for zclOnOffLight2_CmdCallbacks>   30
     ?<Initializer for zclOnOffLight3_CmdCallbacks>   30
     ??zclOnOffLight_Init?relay                        6
     ??zclOnOffLight_event_loop?relay                  6
     ??zclOnOffLight_BasicResetCB?relay                6
     ??zclOnOffLight_IdentifyCB?relay                  6
     ??zclOnOffLight_IdentifyQueryRspCB?relay          6
     ??zclOnOffLight0_OnOffCB?relay                    6
     ??zclOnOffLight1_OnOffCB?relay                    6
     ??zclOnOffLight2_OnOffCB?relay                    6
     ??zclOnOffLight3_OnOffCB?relay                    6
     ??zclOnOffLight_OnOffCB?relay                     6
     ??Device_App_MessageMSGCB?relay                   6

 
 1 141 bytes in segment BANKED_CODE
    66 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
   121 bytes in segment XDATA_I
   121 bytes in segment XDATA_ID
    16 bytes in segment XDATA_Z
 
 1 328 bytes of CODE  memory
     0 bytes of DATA  memory (+ 2 bytes shared)
   137 bytes of XDATA memory

Errors: none
Warnings: none
